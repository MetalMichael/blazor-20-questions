@page "/game/{Id:guid}"
@using Flurl.Http
@using Blazor20Questions.Shared

<h1>Game: @Id</h1>

@if (_error)
{
    <div class="error">
        Error loading game: @_errorMessages
    </div>
}
else if (_game != null)
{
    <div class="game">
        <span>Remaining Questions</span>
    </div>
}
else
{
    <div>Loading...</div>
}

@functions {

    [Parameter]
    public Guid Id { get; set; }

    private GameResponse _game;
    private bool _error;
    private string _errorMessage;

    protected override async Task OnInitAsync()
    {
        try
        {
            _error = false;
            _game = await $"api/Game/{Id}".GetAsync().ReceiveJson<GameResponse>();
        }
        catch (Exception e)
        {
            _error = true;
            _errorMessage = e.Message;
        }
    }

}